import{e as $}from"./index.modern.T7m-bNQW.js";function w(){return w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)({}).hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},w.apply(null,arguments)}function A(e){return"title"!==e.localName&&!e.matches("[data-swup-theme]")}function P(e,t){return e.outerHTML===t.outerHTML}function x(e,t=[]){const s=Array.from(e.attributes);return t.length?s.filter((({name:e})=>t.some((t=>t instanceof RegExp?t.test(e):e===t)))):s}function j(e){return e.matches("link[rel=stylesheet][href]")}class B extends ${constructor(e={}){var t;super(),t=this,this.name="SwupHeadPlugin",this.requires={swup:">=4.6"},this.defaults={persistTags:!1,persistAssets:!1,awaitAssets:!1,attributes:["lang","dir"],timeout:3e3},this.options=void 0,this.updateHead=async function(e,{page:{}}){const{awaitAssets:s,attributes:n,timeout:r}=t.options,o=e.to.document,{removed:i,added:a}=function(e,t,{shouldPersist:s=()=>!1}={}){const n=Array.from(e.children),r=Array.from(t.children),o=(i=n,r.reduce(((e,t,s)=>(i.some((e=>P(t,e)))||e.push({el:t,index:s}),e)),[]));var i;const a=(l=r,n.reduce(((e,t)=>(l.some((e=>P(t,e)))||e.push({el:t}),e)),[]));var l;a.reverse().filter((({el:e})=>A(e))).filter((({el:e})=>!s(e))).forEach((({el:t})=>e.removeChild(t)));const u=o.filter((({el:e})=>A(e))).map((t=>{let s=t.el.cloneNode(!0);return e.insertBefore(s,e.children[(t.index||0)+1]||null),w({},t,{el:s})}));return{removed:a.map((({el:e})=>e)),added:u.map((({el:e})=>e))}}(document.head,o.head,{shouldPersist:e=>t.isPersistentTag(e)});if(t.swup.log(`Removed ${i.length} / added ${a.length} tags in head`),null!=n&&n.length&&function(e,t,s=[]){const n=new Set;for(const{name:r,value:o}of x(t,s))e.setAttribute(r,o),n.add(r);for(const{name:t}of x(e,s))n.has(t)||e.removeAttribute(t)}(document.documentElement,o.documentElement,n),s){const e=function(e,t=0){return e.filter(j).map((e=>function(e,t=0){let s;const n=t=>{e.sheet?t():s=setTimeout((()=>n(t)),10)};return new Promise((r=>{n((()=>r(e))),t>0&&setTimeout((()=>{s&&clearTimeout(s),r(e)}),t)}))}(e,t)))}(a,r);e.length&&(t.swup.log(`Waiting for ${e.length} assets to load`),await Promise.all(e))}},this.options=w({},this.defaults,e),this.options.persistAssets&&!this.options.persistTags&&(this.options.persistTags="link[rel=stylesheet], script[src], style")}mount(){this.before("content:replace",this.updateHead)}isPersistentTag(e){const{persistTags:t}=this.options;return"function"==typeof t?t(e):"string"==typeof t&&t.length>0?e.matches(t):!!t}}export{B as default};